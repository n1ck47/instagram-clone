(this.webpackJsonptest=this.webpackJsonptest||[]).push([[0],{55:function(e,t,s){},56:function(e,t,s){},75:function(e,t,s){},77:function(e,t,s){},78:function(e,t,s){},79:function(e,t,s){},80:function(e,t,s){},81:function(e,t,s){},82:function(e,t,s){},83:function(e,t,s){},84:function(e,t,s){},85:function(e,t,s){"use strict";s.r(t);var o=s(3),n=s.n(o),a=s(23),i=s.n(a),c=s(6),r=(s(55),s(26)),l=s(28),d=s(5),u=s(31),m=s(11),f=s(12),h=s(14),p=s(13),j=(s(56),s(27));j.a.initializeApp({apiKey:"AIzaSyB6tjZFLDVp0RonzzJVYQmXWfmva78oUC0",authDomain:"instagram-clone-a3ccf.firebaseapp.com",projectId:"instagram-clone-a3ccf",storageBucket:"instagram-clone-a3ccf.appspot.com",messagingSenderId:"668991879038",appId:"1:668991879038:web:c8786f0d0c6bdcc6ffa52f"});var g=j.a.firestore(),b=j.a.storage(),v=j.a.auth(),O=s(15),x=s.n(O),w=s(2),y=function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(){var e;return Object(m.a)(this,s),(e=t.call(this)).handleLogout=function(){v.signOut(),e.props.history.push("/")},e.state={showSearch:!1,userSearch:[]},e.searchRef=n.a.createRef(),e}return Object(f.a)(s,[{key:"handleChange",value:function(){var e=this,t=this.searchRef.current.value;""!==(t=t.toLowerCase())?g.collection("users").orderBy("username").limit(30).startAt(t).endAt(t+"\uf8ff").get().then((function(t){var s=[];t.forEach((function(e){var t=e.data(),o={username:t.username,fullName:t.fullName,profileImg:t.profileImg,userId:e.id};s.push(o)})),e.setState({userSearch:s})})):this.setState({userSearch:[]})}},{key:"render",value:function(){var e=this,t=this.state,s=t.showSearch,o=t.userSearch;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("div",{className:"nav",children:[Object(w.jsx)(c.b,{to:"/",children:Object(w.jsx)("img",{alt:"instagram-logo",style:k.image,src:"https://www.instagram.com/static/images/web/mobile_nav_type_logo-2x.png/1b47f9d0e595.png"})}),Object(w.jsxs)("ul",{children:[Object(w.jsx)("li",{children:Object(w.jsx)("img",{alt:"search",style:k.icon,onClick:function(){return e.setState({showSearch:!0,userSearch:[]})},src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fsearch.svg?alt=media&token=c032ad00-a479-40f4-9309-4bf2c4ce9252"})}),Object(w.jsx)("li",{children:Object(w.jsx)(c.b,{to:"/",children:Object(w.jsx)("img",{alt:"home",style:k.icon,src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fhome.svg?alt=media&token=655113dd-cee4-496d-8b83-ee79eb0758a9"})})}),Object(w.jsx)("li",{children:Object(w.jsx)(c.b,{to:"/add",children:Object(w.jsx)("img",{alt:"add",style:k.icon,src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fadd.svg?alt=media&token=341c58f6-d0a8-444f-837a-1970c5cf7b7e"})})}),Object(w.jsx)("li",{children:Object(w.jsx)(c.b,{to:"/profile",children:Object(w.jsx)("img",{alt:"profile",style:k.icon,src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fprofile.svg?alt=media&token=588c8992-ee44-43f5-a462-43b3cf2fb198"})})}),Object(w.jsx)("li",{onClick:this.handleLogout,children:"Log out"}),null===v.currentUser&&Object(w.jsx)(c.b,{to:"/login",children:Object(w.jsx)("li",{children:"Log In"})})]})]}),Object(w.jsx)(x.a,{isOpen:s,onRequestClose:function(){return e.setState({showSearch:!1})},className:"search-modal",children:Object(w.jsxs)("div",{className:"search-main",children:[Object(w.jsx)("div",{className:"search-outer",children:Object(w.jsx)("input",{onChange:function(){return e.handleChange()},ref:this.searchRef,className:"search",type:"text",placeholder:"Search"})}),o.length>0&&Object(w.jsx)("div",{className:"search-result",children:o.map((function(e,t){return Object(w.jsx)(c.b,{to:"/profile-".concat(e.username),children:Object(w.jsxs)("div",{className:"search-result-item",children:[Object(w.jsx)("div",{className:"search-result-item-img",children:Object(w.jsx)("img",{alt:"profile",style:{height:45,widht:45,borderRadius:50},src:e.profileImg})}),Object(w.jsxs)("div",{className:"search-result-item-name",children:[Object(w.jsx)("div",{className:"search-result-item-username",children:e.username}),Object(w.jsx)("div",{className:"search-result-item-fullname",children:e.fullName})]})]})})}))})]})})]})}}]),s}(n.a.Component),k={image:{height:30,width:100},icon:{height:20,width:20}},S=Object(d.e)(y),N=(s(75),function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(){var e;return Object(m.a)(this,s),(e=t.call(this)).onChange=function(e,t){if(e.target.files.length>0){var s=new FileReader;t.setState({file:e.target.files[0]}),s.onload=function(e){var s=e.target.result;"image"===e.target.result.substring(5,10)&&t.setState({isVideo:!1}),"video"===e.target.result.substring(5,10)&&t.setState({isVideo:!0}),t.setState({img:s,loading:!1,excessDuration:!1,opacity:!0})},s.readAsDataURL(e.target.files[0])}},e.handleClick=function(t){e.setState({filter:t[1]})},e.selectStory=function(){e.setState({feedClass:"not-selected",storyClass:"selected"})},e.selectFeed=function(){e.setState({storyClass:"not-selected",feedClass:"selected"})},e.handleVideo=function(){var t=e.videoRef.current.duration;"selected"===e.state.feedClass?t>60?e.setState({excessDuration:!0,opacity:!0}):e.setState({excessDuration:!1,opacity:!1}):t>15?e.setState({excessDuration:!0,opacity:!0}):e.setState({excessDuration:!1,opacity:!1})},e.onUpload=function(t){var s=e.state.file,o=b.ref(),n=t.props,a=n.username,i=n.userId,c=(new Date).getTime(),r=o.child("".concat(a).concat(c,".")+s.name.split(".")[1]),l="";null!==e.captionRef.current&&(l=e.captionRef.current.value),r.put(s).then((function(s){var o=s.ref._delegate.bucket,n=s.ref._delegate.fullPath,r="https://firebasestorage.googleapis.com/v0/b/".concat(o,"/o/").concat(n,"?alt=media"),d=[],u={},m=[];"selected"===e.state.feedClass?g.collection("users").doc(i).get().then((function(e){u=e.data(),d=u.posts})).then((function(){var s=a+c,o={image:r,isVideo:e.state.isVideo,time:c,caption:l,key:s,noOfUpvotes:0,userId:i,username:a,profileImg:u.profileImg,filter:t.state.filter};d.push(o),g.collection("users").doc(i).update({posts:d})})).then((function(){e.setState({loadingModal:!1}),e.props.history.push("/")})):g.collection("users").doc(i).get().then((function(e){u=e.data(),m=u.stories})).then((function(){var s=(new Date).getTime(),o=a+s,n={image:r,isVideo:e.state.isVideo,time:s,key:o,userId:i,username:a,profileImg:u.profileImg,filter:t.state.filter};m.push(n),g.collection("users").doc(i).update({stories:m})})).then((function(){e.setState({loadingModal:!1}),e.props.history.push("/")}))})),e.setState({loadingModal:!0})},e.state={img:"",loading:!0,filter:"",feedClass:"selected",storyClass:"not-selected",excessDuration:!1,opacity:!0,isVideo:!1,file:[],loadingModal:!1},e.videoRef=n.a.createRef(),e.captionRef=n.a.createRef(),e}return Object(f.a)(s,[{key:"render",value:function(){var e=this,t=this.state,s=t.img,o=t.loading,n=t.filter,a=t.feedClass,i=t.storyClass,c=t.excessDuration,r=t.opacity,l=t.isVideo,d=t.loadingModal;return Object(w.jsxs)("div",{className:"add-post-outer",children:[Object(w.jsxs)("div",{className:"add-post",children:[Object(w.jsx)("div",{className:"add-post-caption",children:Object(w.jsx)("textarea",{ref:this.captionRef,placeholder:"Write a caption...",maxLength:"100"})}),Object(w.jsxs)("div",{className:"inp-outer",children:[Object(w.jsx)("img",{alt:"upload",src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fupload.svg?alt=media&token=3a19021b-1e72-486d-a964-2174a64980e5",className:"inp-img"}),Object(w.jsx)("input",{style:I.inp,className:"inp",type:"file",onChange:function(t){return e.onChange(t,e)}})]}),Object(w.jsx)("div",{className:"create-post-button",children:Object(w.jsx)("button",{onClick:function(){return e.onUpload(e)},children:"Post"})})]}),o&&Object(w.jsx)("div",{className:"nav-post",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:i,onClick:this.selectStory,children:"Story"}),Object(w.jsx)("div",{className:a,onClick:this.selectFeed,children:"Feed"})]})}),l&&!o&&Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("div",{className:"main-post",children:"selected"===a?c?Object(w.jsx)("div",{children:"Video Duration Exceed"}):Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("video",{ref:this.videoRef,className:r?"opacity":"",onTimeUpdate:this.handleVideo,width:I.img.width,style:I.img,controls:!0,muted:!0,autoPlay:!0,children:Object(w.jsx)("source",{src:s,type:"video/mp4"})})}):c?Object(w.jsx)("div",{children:"Video Duration Exceed"}):Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("video",{ref:this.videoRef,className:r?"opacity":"",onTimeUpdate:this.handleVideo,width:I.img.width,style:I.story,controls:!0,muted:!0,autoPlayx:!0,children:Object(w.jsx)("source",{src:s,type:"video/mp4"})})})})}),!l&&!o&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"main-post",children:"selected"===a?Object(w.jsx)("figure",{className:n,style:{width:"654px"},children:Object(w.jsx)("img",{alt:"post",src:s,style:I.img})}):Object(w.jsx)("figure",{className:n,style:{width:"400px"},children:Object(w.jsx)("img",{alt:"post",src:s,style:I.story})})}),Object(w.jsxs)("div",{className:"post-filters-outer",children:[Object(w.jsx)("div",{children:"FILTERS"}),Object(w.jsx)("ul",{className:"post-filters-inner",children:R.map((function(t){return Object(w.jsxs)("li",{onClick:function(){return e.handleClick(t)},children:[Object(w.jsx)("figure",{className:t[1],style:{width:"150px"},children:Object(w.jsx)("img",{alt:"filters",src:s,style:I.filter})}),Object(w.jsx)("div",{children:t[0]})]},t[1])}))})]})]}),Object(w.jsx)(x.a,{isOpen:d,className:"loading-modal",children:Object(w.jsx)("img",{alt:"loading",src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Floading.svg?alt=media&token=0159e16f-9cd1-4dd9-851d-fa3ad32a9896"})})]})}}]),s}(n.a.Component)),I={img:{width:"654px",maxWidth:"100%"},story:{width:"400px",height:"710px",objectFit:"contain",backgroundColor:"black"},filter:{width:"150px",maxWidth:"100%"}},R=[["Original",""],["1977","_1977"],["Aden","aden"],["Brannan","brannan"],["Brooklyn","brooklyn"],["Clarendon","clarendon"],["Earlybird","earlybird"],["Gingham","gingham"],["Hudson","hudson"],["Inkwell","inkwell"],["Kelvin","kelvin"],["Lark","lark"],["Lo-Fi","lofi"],["Maven","maven"],["Mayfair","mayfair"],["Moon","moon"],["Nashville","nashville"],["Perpetua","perpetua"],["Reyes","reyes"],["Rise","rise"],["Slumber","slumber"],["Stinson","stinson"],["Toaster","toaster"],["Valencia","valencia"],["Walden","walden"],["Willow","willow"],["X-pro II","xpro2"]],C=Object(d.e)(N),F=function(e){return{type:"UPDATE_USER",user:e}},P=function(e){return{type:"UPDATE_POST",posts:e}},U=function(e){return{type:"UPDATE_BOOKMARK",bookmarks:e}},M=function(e){return{type:"UPDATE_UPVOTE",upvotes:e}},D=function(e){return{type:"UPDATE_DOWNVOTE",downvotes:e}},E=s(47),T=(s(76),s(77),function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(){var e;return Object(m.a)(this,s),(e=t.call(this)).convertMS=function(e){var t,s,o;o=Math.floor(e/1e3),s=Math.floor(o/60),o%=60,t=Math.floor(s/60),s%=60;var n="";return 0!==(t%=24)?n="".concat(t,"h"):0!==s?n="".concat(s,"m"):0!==o&&(n="".concat(o,"s")),n},e.handleStoryClick=function(){e.setState({isModalOpened:!0}),e.setState({interval:setInterval((function(){var t=e.props.stories,s=e.state.index;e.setState({index:s+1}),(s=e.state.index)>=t.length&&(e.setState({isModalOpened:!1,index:0}),clearInterval(e.state.interval))}),1e4)})},e.handleModalClose=function(){clearInterval(e.state.interval),e.setState({isModalOpened:!1,index:0})},e.state={isModalOpened:!1,index:0,interval:null},e}return Object(f.a)(s,[{key:"render",value:function(){var e=this,t=this.state,s=t.isModalOpened,o=t.index,n=this.props.stories,a=new Date-n[o].time,i=this.convertMS(a);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("div",{className:"story-card",children:[Object(w.jsx)("img",{alt:"profile",onClick:this.handleStoryClick,style:W.image,src:n[0].profileImg}),Object(w.jsx)(E.a,{delay:[700,null],placement:"bottom-start",arrow:!1,content:Object(w.jsx)("div",{style:W.tippy,children:n[0].username}),children:Object(w.jsx)("div",{className:"story-card-username",children:n[0].username})})]}),o<n.length&&Object(w.jsx)(x.a,{isOpen:s,onRequestClose:function(){return e.handleModalClose()},className:"story-modal",children:Object(w.jsx)("div",{className:"story-modal-outer",children:Object(w.jsxs)("div",{className:"story-modal-inner",children:[Object(w.jsxs)("div",{className:"story-modal-inner-top",children:[Object(w.jsx)("img",{alt:"profile",style:W.icon,src:n[o].profileImg}),Object(w.jsx)("div",{style:W.username,children:n[o].username}),Object(w.jsx)("div",{style:{marginLeft:10,color:"grey",fontWeight:400},children:i})]}),!1===n[o].isVideo&&Object(w.jsx)("img",{alt:"story",onClick:function(){e.setState({index:o+1}),clearInterval(e.state.interval),e.handleStoryClick()},className:"story-modal-inner-bottom",style:W.story,src:n[o].image}),!0===n[o].isVideo&&Object(w.jsx)("video",{width:400,className:"story-modal-inner-bottom",style:W.story,controls:!0,children:Object(w.jsx)("source",{src:n[o].image,type:"video/mp4"})})]})})})]})}}]),s}(n.a.Component)),W={image:{height:56,width:56,borderRadius:50,padding:1.2,border:"2px solid black",marginRight:20},tippy:{fontSize:10},story:{width:"400px",height:"710px",objectFit:"contain",backgroundColor:"black",maxWidth:"100%"},icon:{height:32,width:32,borderRadius:50,marginRight:15},username:{color:"white",fontWeight:700}},V=T,_=(s(78),function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(){var e;return Object(m.a)(this,s),(e=t.call(this)).state={stories:{},loading:!0},e}return Object(f.a)(s,[{key:"componentDidMount",value:function(){var e=this,t=this.props,s=t.userId,o=t.store,n={};g.collection("users").doc(s).get().then((function(t){var a=t.data(),i=a.following;if(a.stories.length>0){var c=a.stories;c.sort((function(e,t){return t.time-e.time}));var r=new Date;r=r.getTime(),(c=c.filter((function(e){return r-e.time<36e5}))).length>0&&(n[s]=c)}(i=Object.keys(i)).push(s);var l=0,d=Object.keys(i).length;i.forEach((function(t){l+=1,g.collection("users").doc(t).get().then((function(s){var a=s.data();if(a.stories.length>0){var i=a.stories;i.sort((function(e,t){return t.time-e.time}));var c=new Date;c=c.getTime(),(i=i.filter((function(e){return c-e.time<864e5}))).length>0&&(n[t]=i)}l===d&&(o.dispatch(function(e){return{type:"UPDATE_STORY",stories:e}}(n)),e.setState({stories:n,loading:!1}))}))}))}))}},{key:"render",value:function(){var e=this.state,t=e.stories,s=e.loading;return Object(w.jsx)("div",{className:"story-outer",children:Object(w.jsx)("div",{className:"story",children:!s&&Object.keys(t).map((function(e){return Object(w.jsx)(V,{userId:e,stories:t[e]},e)}))})})}}]),s}(n.a.Component)),A=s(30),L=(s(79),function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(){var e;return Object(m.a)(this,s),(e=t.call(this)).convertMS=function(e){var t,s,o,n;n=Math.floor(e/1e3),o=Math.floor(n/60),n%=60,s=Math.floor(o/60),o%=60,t=Math.floor(s/24),s%=24;var a=0,i=0,c=0,r="";return t>0&&(a=Math.floor(t/7),i=Math.floor(t/30),c=Math.floor(t/365)),0!==c?r="".concat(c,1===c?" year ago":" years ago"):0!==i?r="".concat(i,1===i?" month ago":" months ago"):0!==a?r="".concat(a,1===a?" week ago":" weeks ago"):0!==t?r="".concat(t,1===t?" day ago":" days ago"):0!==s?r="".concat(s,1===s?" hour ago":" hours ago"):0!==o?r="".concat(o,1===o?" minute ago":" minutes ago"):0!==n&&(r="".concat(n,1===n?" second ago":" seconds ago")),r},e.handleUpvote=function(){var t=e.props,s=t.store,o=t.post,n=t.userId,a=o.key,i=s.getState(),c=i.upvoteState,r=i.downvoteState,l=-1,d=e.state.noOfUpvotes;if(c.forEach((function(e,t){e.key===a&&(l=t)})),-1===l){e.setState({isUpvoted:!0,isDownvoted:!1}),c.push(o),d+=1,e.setState({noOfUpvotes:d}),s.dispatch(M(c));var u=-1;r.forEach((function(e,t){e.key===a&&(u=t)})),-1!==u&&(r=r.filter((function(e,t){return t!==u})),s.dispatch(D(r)),d+=1,e.setState({noOfUpvotes:d}))}else d-=1,e.setState({isUpvoted:!1,noOfUpvotes:d}),c=c.filter((function(e,t){return t!==l})),s.dispatch(M(c)),e.props.upvotePost&&e.props.upvotePost(n,a);c=s.getState().upvoteState,r=s.getState().downvoteState,o.noOfUpvotes=d,g.collection("users").doc(n).update({upvotes:c,downvotes:r}),g.collection("users").doc(o.userId).get().then((function(e){var t=e.data().posts;(t=t.filter((function(e,t){return e.key!==o.key}))).push(o),g.collection("users").doc(o.userId).update({posts:t})}))},e.handleDownvote=function(){var t=e.props,s=t.store,o=t.post,n=t.userId,a=o.key,i=s.getState(),c=i.upvoteState,r=i.downvoteState,l=-1,d=e.state.noOfUpvotes;if(r.forEach((function(e,t){e.key===a&&(l=t)})),-1===l){e.setState({isUpvoted:!1,isDownvoted:!0}),r.push(o),d-=1,s.dispatch(D(r));var u=-1;c.forEach((function(e,t){e.key===a&&(u=t)})),-1!==u&&(d-=1,c=c.filter((function(e,t){return t!==u})),s.dispatch(M(c))),e.setState({noOfUpvotes:d}),e.props.upvotePost&&e.props.upvotePost(n,a)}else d+=1,e.setState({isDownvoted:!1,noOfUpvotes:d}),r=r.filter((function(e,t){return t!==l})),s.dispatch(D(r));c=s.getState().upvoteState,r=s.getState().downvoteState,o.noOfUpvotes=d,g.collection("users").doc(n).update({upvotes:c,downvotes:r}),g.collection("users").doc(o.userId).get().then((function(e){var t=e.data().posts;(t=t.filter((function(e,t){return e.key!==o.key}))).push(o),g.collection("users").doc(o.userId).update({posts:t})}))},e.handleBookmark=function(){var t=e.props,s=t.store,o=t.post,n=t.userId,a=o.key,i=s.getState().bookmarkState,c=-1;i.forEach((function(e,t){e.key===a&&(c=t)})),-1===c?(e.setState({isBookmarked:!0}),i.push(o),s.dispatch(U(i))):(e.setState({isBookmarked:!1}),i=i.filter((function(e,t){return t!==c})),s.dispatch(U(i)),e.props.bookmarkPost&&e.props.bookmarkPost(n,a)),g.collection("users").doc(n).update({bookmarks:i})},e.handleDelete=function(){var t=e.props.post;e.props.deletePost(t.userId,t.key)},e.handleEditClick=function(){e.setState({editSelected:!0})},e.handleEdit=function(){var t=e.props.post,s="";null!==e.captionRef.current&&(s=e.captionRef.current.value),e.setState({editSelected:!1}),e.props.modifyPost(t.userId,t.key,s,t)},e.handleComment=function(){var t="";null!==e.commentRef.current&&(t=e.commentRef.current.value),""===t?e.setState({commentEnter:!1}):e.setState({commentEnter:!0})},e.handleCommentEnter=function(){var t=new Date;t=t.getTime();var s=e.props,o=s.post,n=s.store,a=e.props.userId,i=e.props.username,c=e.props.profileImg,r=o.userId,l="".concat(r).concat(t),d="";null!==e.commentRef.current&&(d=e.commentRef.current.value),e.commentRef.current.value="";var u=o.key;void 0===o.comment&&(o.comment={}),o.comment[l]=[],o.comment[l].push(a),o.comment[l].push(i),o.comment[l].push(d),o.comment[l].push(t),o.comment[l].push(a+t),o.comment[l].push(c);var m=n.getState().postState;(m=m.filter((function(e,t){return e.key!==u}))).push(o),n.subscribe((function(){return e.forceUpdate()}));var f=[];g.collection("users").doc(r).get().then((function(t){var s=t.data();(f=s.posts.filter((function(e,t){return e.key!==u}))).push(o),g.collection("users").doc(r).update({posts:f}).then((function(){n.dispatch(P(m)),e.componentDidMount()})).catch((function(e){}))}))},e.handleCommentClick=function(){e.setState({isModalOpen:!0})},e.state={isUpvoted:!1,isDownvoted:!1,isBookmarked:!1,noOfUpvotes:0,editSelected:!1,time:"",commentEnter:!1,isComment:!1,comments:[],isModalOpen:!1,isCommentModal:!1},e.captionRef=n.a.createRef(),e.commentRef=n.a.createRef(),e}return Object(f.a)(s,[{key:"componentDidMount",value:function(){var e=this.props,t=e.store,s=e.post;e.commentModal&&this.setState({isCommentModal:!0}),this.setState({noOfUpvotes:s.noOfUpvotes});var o=t.getState(),n=o.upvoteState,a=o.downvoteState,i=o.bookmarkState,c=s.key,r={};void 0!==s.comment&&(r=s.comment);var l=[];Object.keys(r).length;for(var d in r)l.push(r[d]),l.sort((function(e,t){return t[3]-e[3]})),this.setState({comments:l}),Object.keys(r).length>0&&this.setState({isComment:!0});var u=s.time,m=new Date,f=(m=m.getTime())-u;this.setState({time:this.convertMS(f)});var h=-1;n.forEach((function(e,t){e.key===c&&(h=t)})),-1===h?this.setState({isUpvoted:!1}):this.setState({isUpvoted:!0}),h=-1,a.forEach((function(e,t){e.key===c&&(h=t)})),-1===h?this.setState({isDownvoted:!1}):this.setState({isDownvoted:!0}),h=-1,i.forEach((function(e,t){e.key===c&&(h=t)})),-1===h?this.setState({isBookmarked:!1}):this.setState({isBookmarked:!0})}},{key:"render",value:function(){var e=this,t=this.props.post,o=t.profileImg,n=t.username,a=t.image,i=t.userId,r=t.caption,l=t.noOfUpvotes,d=t.isVideo,u=t.filter,m=this.props.userId,f=this.state,h=f.isUpvoted,p=f.isDownvoted,j=(f.isBookmarked,f.editSelected),g=f.time,b=f.commentEnter,v=f.comments,O=f.isComment,y=f.isModalOpen,k=f.isCommentModal;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"post-card-outer",children:Object(w.jsxs)("div",{className:"post-card",children:[Object(w.jsxs)("div",{className:"post-card-top",children:[Object(w.jsxs)("div",{className:"post-card-top-first",children:[Object(w.jsx)(c.b,{to:"/profile-".concat(n),children:Object(w.jsx)("img",{alt:"profile",style:q.profile,src:o})}),Object(w.jsx)(c.b,{to:"/profile-".concat(n),style:{textDecoration:"none",color:"black"},children:Object(w.jsx)("h5",{children:n})})]}),i===m&&Object(w.jsxs)("div",{className:"post-card-top-second",children:[j&&Object(w.jsx)("textarea",{ref:this.captionRef,placeholder:"Write a caption...",maxLength:"100"}),j?Object(w.jsx)("img",{alt:"edit",onClick:this.handleEdit,src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fenter.svg?alt=media&token=7b8b3714-7a13-460a-92bd-03548bfd4c7e"}):Object(w.jsx)("img",{alt:"edit-2",onClick:this.handleEditClick,src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fedit.svg?alt=media&token=fedef40a-ff25-4d09-bfcb-8db4391ca2b0"}),Object(w.jsx)("img",{alt:"delete",onClick:this.handleDelete,src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fdelete.svg?alt=media&token=8b3a5890-8de1-4a63-b76c-daef0a96f759"})]})]}),Object(w.jsx)("div",{className:"post-card-post",children:d?Object(w.jsx)("video",{width:q.post.width,style:q.post,controls:!0,children:Object(w.jsx)("source",{src:a,type:"video/mp4"})}):Object(w.jsxs)("figure",{className:u,style:{width:"654px"},children:[Object(w.jsx)("img",{alt:"post",style:q.post,src:a})," "]})}),Object(w.jsx)("div",{className:"post-card-actions",children:Object(w.jsxs)("div",{className:"post-card-actions-upvotes",children:[h?Object(w.jsx)("img",{alt:"upvote",onClick:function(){return e.handleUpvote()},src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fupvote-fill.svg?alt=media&token=945a6d75-951e-4430-bc8e-e925dbb7c65c"}):Object(w.jsx)("img",{alt:"upvote-1",onClick:function(){return e.handleUpvote()},src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fupvote.svg?alt=media&token=ecf11599-0904-4713-bf85-0ed045f4f430"}),p?Object(w.jsx)("img",{alt:"downvote",onClick:function(){return e.handleDownvote()},src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fdownvote-fill.svg?alt=media&token=bc0c21d7-0380-4fb3-a615-0a5fdaa20e77"}):Object(w.jsx)("img",{alt:"downvote-1",onClick:function(){return e.handleDownvote()},src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fdownvote.svg?alt=media&token=6f224cc0-8f1d-4b89-b933-0f7702bc66fd"})]})}),Object(w.jsx)("div",{style:{marginTop:10},className:"post-card-upvotes",children:Object(w.jsxs)("div",{style:{fontWeight:500,fontSize:13,marginLeft:15},children:[Math.abs(l),l>=0?" Upvotes":" Downvotes"]})}),Object(w.jsxs)("div",{className:"post-card-bottom",children:[Object(w.jsx)(c.b,{to:"/profile-".concat(n),style:{textDecoration:"none",color:"black"},children:Object(w.jsx)("div",{style:{marginRight:10,fontWeight:600,fontSize:13},children:n})}),Object(w.jsx)("div",{style:{fontSize:13},children:r})]}),!k&&Object(w.jsxs)("div",{className:"post-card-all-comments",children:[O&&Object(w.jsxs)("div",{onClick:this.handleCommentClick,className:"post-card-all-comments-first",children:["View all ",v.length," Comments"]}),O&&Object(w.jsxs)("div",{className:"post-card-all-comments-second",children:[Object(w.jsx)(c.b,{to:"/profile-".concat(v[0][1]),style:{textDecoration:"none",color:"black"},children:Object(w.jsx)("div",{className:"post-card-all-comments-second-username",children:v[0][1]})}),Object(w.jsx)("div",{className:"post-card-all-comments-second-comment",children:v[0][2]})]})]}),Object(w.jsx)("div",{className:"post-card-time",children:Object(w.jsx)("div",{children:g})}),!k&&Object(w.jsxs)("div",{className:"post-card-comments",children:[Object(w.jsx)("textarea",{ref:this.commentRef,onChange:function(){return e.handleComment()},placeholder:"Add a comment..."}),b&&Object(w.jsx)("img",{alt:"comment",style:q.icon,onClick:this.handleCommentEnter,src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fenter.svg?alt=media&token=7b8b3714-7a13-460a-92bd-03548bfd4c7e"})]})]})}),!k&&Object(w.jsxs)(x.a,{isOpen:y,onRequestClose:function(){return e.setState({isModalOpen:!1})},className:"comments-modal",children:[Object(w.jsx)(s,{className:"comments-modal-left",modifyPost:this.modifyPost,userId:this.props.userId,upvotePost:this.upvotePost,deletePost:this.deletePost,post:this.props.post,store:this.props.store,commentModal:!0}),Object(w.jsx)("div",{className:"comments-modal-right",children:v.map((function(t,s){var o=(new Date).getTime();return o-=t[3],Object(w.jsxs)("div",{className:"comments-modal-inner",children:[Object(w.jsx)(c.b,{to:"/profile-".concat(t[1]),style:{textDecoration:"none",color:"black"},children:Object(w.jsx)("img",{alt:"post-1",style:q.profile,src:t[5]})}),Object(w.jsxs)("div",{className:"comments-modal-inner-right",children:[Object(w.jsxs)("div",{className:"comments-modal-inner-top",children:[Object(w.jsx)(c.b,{to:"/profile-".concat(t[1]),style:{textDecoration:"none",color:"black"},children:Object(w.jsx)("div",{className:"comments-modal-username",children:t[1]})}),Object(w.jsx)("div",{className:"comments-modal-comment",children:t[2]})]}),Object(w.jsx)("div",{className:"comments-modal-time",children:e.convertMS(o)})]})]},t[4])}))})]})]})}}]),s}(n.a.Component)),q={profile:{height:32,width:32,borderRadius:50,marginRight:15,marginLeft:15},post:{width:"654px",height:"auto",maxWidth:"100%"},icon:{width:25,height:25,marginRight:25}},B=L;s(80);x.a.setAppElement("#root");var z=function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(){var e;return Object(m.a)(this,s),(e=t.call(this)).deletePost=function(t,s){var o=e.props.store;o.subscribe((function(){return e.forceUpdate()}));var n=o.getState().postState,a=n.filter((function(e,t){return e.key!==s})),i=n.filter((function(e,o){return e.userId===t&&e.key!==s}));g.collection("users").doc(t).update({posts:i}),o.dispatch(P(a))},e.modifyPost=function(t,s,o,n){var a=e.props.store;a.subscribe((function(){return e.forceUpdate()})),n.caption=o;var i=a.getState().postState,c=i.filter((function(e,t){return e.key!==s}));(i=i.filter((function(e,o){return e.userId===t&&e.key!==s}))).push(n),c.push(n),g.collection("users").doc(t).update({posts:i}),a.dispatch(P(c))},e.handleModalClick=function(t){e.setState({post:t,isOpened:!0})},e.handleFollowing=function(){var t=e.state.isFollowing,s=e.props.userId,o=e.state.userId,n=e.state.noOfFollowers;!0===t?(g.collection("users").doc(s).get().then((function(t){var n=t.data().following;delete n[o],g.collection("users").doc(s).update({following:n}),delete(n=e.state.following)[o],e.setState({following:n})})),g.collection("users").doc(o).get().then((function(t){var n=t.data().following;delete n[s],g.collection("users").doc(o).update({followers:n}),delete(n=e.state.followers)[o],e.setState({followers:n})})),e.setState({isFollowing:!1,noOfFollowers:n-1})):(g.collection("users").doc(s).get().then((function(e){var t=e.data().following;t[o]=!0,g.collection("users").doc(s).update({following:t})})),g.collection("users").doc(o).get().then((function(e){var t=e.data().followers;t[s]=!0,g.collection("users").doc(o).update({followers:t})})),e.setState({isFollowing:!0,noOfFollowers:n+1}))},e.handleUsername=function(){var t=e.usernameRef.current.value;(t=t.toLowerCase()).length>5?g.collection("users").where("username","==",t).get().then((function(s){if(!0===s.empty){e.usernameRef.current.value="";var o=e.state.user;o.username=t,v.currentUser.updateProfile({displayName:t}),g.collection("users").doc(e.props.userId).update({username:t}),e.setState({user:o})}else alert("Username not available")})):alert("Username must consist of 6 or more characters")},e.handleName=function(){var t=e.nameRef.current.value;if(t.length>0){e.nameRef.current.value="";var s=e.state.user;s.fullName=t,g.collection("users").doc(e.props.userId).update({fullName:t}),e.setState({user:s})}},e.handlePassword=function(){var t=e.passwordRef.current.value;t.length>5?(e.passwordRef.current.value="",v.currentUser.updatePassword(t).then((function(){})).catch((function(e){}))):alert("Password must consist of 6 or more characters")},e.handleBio=function(){var t=Object(A.a)(e),s=t.bioRef.current.value;if(s.length>0){t.bioRef.current.value="";var o=t.state.user;o.bio=s,g.collection("users").doc(t.props.userId).update({bio:s}),t.setState({user:o,settingsModal:!1})}},e.onChange=function(e,t){if(e.target.files.length>0){var s=new FileReader,o=e.target.files[0];s.onload=function(e){var s=e.target.result;if("image"===e.target.result.substring(5,10)){t.setState({img:s});var n=b.ref(),a=t.props.username,i=(new Date).getTime();n.child("".concat(a).concat(i,".")+o.name.split(".")[1]).put(o).then((function(e){var s=e.ref._delegate.bucket,o=e.ref._delegate.fullPath,n="https://firebasestorage.googleapis.com/v0/b/".concat(s,"/o/").concat(o,"?alt=media"),a=t.state.user;v.currentUser.updateProfile({photoURL:n}),a.profileImg=n,g.collection("users").doc(t.props.userId).update({profileImg:n}),t.setState(a)}))}},s.readAsDataURL(e.target.files[0])}},e.state={noOfPosts:0,loading:!0,isOpened:!1,post:{},user:{},userId:"",isFollowing:!1,noOfFollowers:0,noOfFollowing:0,followers:{},following:{},followersModal:!1,followingModal:!1,postFullname:"",postProfileImg:"",onlineFullname:"",settingsModal:!1,img:""},e.usernameRef=n.a.createRef(),e.nameRef=n.a.createRef(),e.bioRef=n.a.createRef(),e.passwordRef=n.a.createRef(),e}return Object(f.a)(s,[{key:"componentDidMount",value:function(){var e=this,t=this.props,s=t.store,o=t.userId,n=this.props.match.url.split("-")[1];void 0!==n?g.collection("users").where("username","==",n).get().then((function(t){var o="";t.forEach((function(e){o=e.id})),g.collection("users").doc(e.props.userId).get().then((function(t){var s=t.data(),n=s.following;Object.keys(n).forEach((function(t){t===o?e.setState({isFollowing:!0,onlineFullname:s.fullName}):e.setState({isFollowing:!1,onlineFullname:s.fullName})}))})),s.subscribe((function(){return e.forceUpdate()})),g.collection("users").doc(o).get().then((function(t){var n=t.data(),a=n,i=n.followers,c=n.following,r={},l={},d=0,u=0,m=Object.keys(c).length,f=Object.keys(i).length;0===m&&0===f&&(a.posts.sort((function(e,t){return t.time-e.time})),s.dispatch(F(a)),e.setState({postFullname:n.fullName,postProfileImg:n.profileImg,user:a,noOfPosts:a.posts.length,loading:!1,userId:o,noOfFollowers:f,noOfFollowing:m,followers:r,following:l})),Object.keys(i).forEach((function(t){g.collection("users").doc(t).get().then((function(e){var s=e.data();r[t]=[s.username,s.fullName,s.profileImg],d+=1})).then((function(){d===f&&u===m&&(a.posts.sort((function(e,t){return t.time-e.time})),s.dispatch(F(a)),e.setState({postFullname:n.fullName,postProfileImg:n.profileImg,user:a,noOfPosts:a.posts.length,loading:!1,userId:o,noOfFollowers:f,noOfFollowing:m,followers:r,following:l}))}))})),Object.keys(c).forEach((function(t){g.collection("users").doc(t).get().then((function(e){var s=e.data();l[t]=[s.username,s.fullName,s.profileImg],u+=1})).then((function(){d===f&&u===m&&(a.posts.sort((function(e,t){return t.time-e.time})),s.dispatch(F(a)),e.setState({postFullname:n.fullName,postProfileImg:n.profileImg,user:a,noOfPosts:a.posts.length,loading:!1,userId:o,noOfFollowers:f,noOfFollowing:m,followers:r,following:l}))}))}))}))})):(s.subscribe((function(){return e.forceUpdate()})),g.collection("users").doc(o).get().then((function(t){var n=t.data(),a=n,i=n.followers,c=n.following,r={},l={},d=0,u=0,m=Object.keys(c).length,f=Object.keys(i).length;0===m&&0===f&&(a.posts.sort((function(e,t){return t.time-e.time})),s.dispatch(F(a)),e.setState({postFullname:n.fullName,postProfileImg:n.profileImg,user:a,noOfPosts:a.posts.length,loading:!1,userId:o,noOfFollowers:f,noOfFollowing:m,followers:r,following:l})),Object.keys(i).forEach((function(t){g.collection("users").doc(t).get().then((function(e){var s=e.data();r[t]=[s.username,s.fullName,s.profileImg],d+=1})).then((function(){d===f&&u===m&&(a.posts.sort((function(e,t){return t.time-e.time})),s.dispatch(F(a)),e.setState({user:a,noOfPosts:a.posts.length,loading:!1,noOfFollowers:f,noOfFollowing:m,followers:r,following:l}))}))})),Object.keys(c).forEach((function(t){g.collection("users").doc(t).get().then((function(e){var s=e.data();l[t]=[s.username,s.fullName,s.profileImg],u+=1})).then((function(){d===f&&u===m&&(a.posts.sort((function(e,t){return t.time-e.time})),s.dispatch(F(a)),e.setState({user:a,noOfPosts:a.posts.length,loading:!1,noOfFollowers:f,noOfFollowing:m,followers:r,following:l}))}))}))})))}},{key:"render",value:function(){var e=this,t=this.props.store,s=this.state,o=(s.img,s.loading),n=s.noOfPosts,a=s.post,i=s.isOpened,r=s.user,l=s.isFollowing,d=s.noOfFollowers,u=s.noOfFollowing,m=s.followersModal,f=s.followingModal,h=s.followers,p=s.following,j=s.settingsModal,g=this.props.userId,b=this.state.userId;return""===this.state.userId?this.props.userId:this.state.userId,Object(w.jsxs)(w.Fragment,{children:[!o&&Object(w.jsxs)("div",{className:"profile",children:[Object(w.jsxs)("div",{className:"profile-inner",children:[Object(w.jsxs)("div",{className:"profile-top",children:[Object(w.jsx)("div",{className:"profile-left",children:Object(w.jsx)("img",{alt:"profile",style:X.image,src:r.profileImg})}),Object(w.jsxs)("div",{className:"profile-right",children:[Object(w.jsxs)("div",{className:"profile-right-first",children:[Object(w.jsx)("div",{style:X.username,children:r.username}),""!==b&&b!==g&&(l?Object(w.jsx)("button",{style:{backgroundColor:"white",color:"black",border:"1px solid #dbdbdb"},onClick:this.handleFollowing,children:"Following"}):Object(w.jsx)("button",{onClick:this.handleFollowing,children:"Follow"})),(""===b||b===g)&&Object(w.jsx)("img",{alt:"settings",onClick:function(){return e.setState({settingsModal:!e.state.settingsModal})},style:X.icon,src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fsettings.svg?alt=media&token=fedef40a-ff25-4d09-bfcb-8db4391ca2b0"})]}),Object(w.jsxs)("div",{className:"profile-right-second",children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{style:{fontWeight:600},children:n})," posts"]}),Object(w.jsxs)("div",{onClick:function(){return e.setState({followersModal:!0})},children:[Object(w.jsx)("span",{style:{fontWeight:600},children:d})," followers"]}),Object(w.jsxs)("div",{onClick:function(){return e.setState({followingModal:!0})},children:[Object(w.jsx)("span",{style:{fontWeight:600},children:u})," following"]})]}),Object(w.jsxs)("div",{className:"profile-right-third",children:[Object(w.jsx)("div",{className:"profile-right-third-name",children:Object(w.jsx)("div",{style:X.fullName,children:r.fullName})}),Object(w.jsx)("div",{style:X.bio,children:r.bio})]})]})]}),Object(w.jsxs)("div",{className:"profile-bottom",children:[r.posts.map((function(t,s){return Object(w.jsx)("img",{alt:"post",onClick:function(){return e.handleModalClick(t)},src:t.image},t.key)})),0===r.posts.length&&Object(w.jsxs)("div",{className:"no-data",children:[Object(w.jsx)("div",{children:"No Posts to show"}),Object(w.jsx)("div",{children:Object(w.jsx)(c.b,{to:"/add",children:"Create Post"})})]})]}),0!==Object.keys(r.posts).length&&Object(w.jsx)(x.a,{isOpen:i,onRequestClose:function(){return e.setState({isOpened:!1})},className:"upvotes-post-card",children:Object(w.jsx)(B,{modifyPost:this.modifyPost,username:this.props.username,profileImg:this.props.profileImg,userId:g,postUserId:this.state.userId,upvotePost:this.upvotePost,deletePost:this.deletePost,post:a,store:t})})]}),Object(w.jsx)(x.a,{isOpen:m,onRequestClose:function(){return e.setState({followersModal:!1})},className:"followers-modal",children:Object(w.jsxs)("div",{className:"followers-modal-inner",children:[Object(w.jsxs)("div",{className:"followers-top",children:[Object(w.jsx)("div",{}),Object(w.jsx)("div",{children:"Followers"}),Object(w.jsx)("div",{onClick:function(){return e.setState({followersModal:!1})},children:Object(w.jsx)("img",{alt:"cross",src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fcross.svg?alt=media&token=6228795e-4864-471d-8cbc-81162e190077"})})]}),Object(w.jsx)("div",{className:"followers-list",children:Object.keys(h).map((function(e){return Object(w.jsx)(c.b,{to:"/profile-".concat(h[e][0]),children:Object(w.jsxs)("div",{className:"followers-result-item",children:[Object(w.jsx)("div",{className:"followers-result-item-img",children:Object(w.jsx)("img",{alt:"profile",style:{height:30,width:30,borderRadius:50},src:h[e][2]})}),Object(w.jsxs)("div",{className:"followers-result-item-name",children:[Object(w.jsx)("div",{className:"followers-result-item-username",children:h[e][0]}),Object(w.jsx)("div",{className:"followers-result-item-fullname",children:h[e][1]})]})]})},e)}))})]})}),Object(w.jsx)(x.a,{isOpen:f,onRequestClose:function(){return e.setState({followingModal:!1})},className:"followers-modal",children:Object(w.jsxs)("div",{className:"followers-modal-inner",children:[Object(w.jsxs)("div",{className:"followers-top",children:[Object(w.jsx)("div",{}),Object(w.jsx)("div",{children:"Following"}),Object(w.jsx)("div",{onClick:function(){return e.setState({followingModal:!1})},children:Object(w.jsx)("img",{alt:"cross",src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Fcross.svg?alt=media&token=6228795e-4864-471d-8cbc-81162e190077"})})]}),Object(w.jsx)("div",{className:"followers-list",children:Object.keys(p).map((function(e){return Object(w.jsx)(c.b,{to:"/profile-".concat(p[e][0]),children:Object(w.jsxs)("div",{className:"followers-result-item",children:[Object(w.jsx)("div",{className:"followers-result-item-img",children:Object(w.jsx)("img",{alt:"profile",style:{height:30,width:30,borderRadius:50},src:p[e][2]})}),Object(w.jsxs)("div",{className:"followers-result-item-name",children:[Object(w.jsx)("div",{className:"followers-result-item-username",children:p[e][0]}),Object(w.jsx)("div",{className:"followers-result-item-fullname",children:p[e][1]})]})]})},e)}))})]})})]}),Object(w.jsx)(x.a,{isOpen:o,className:"loading-modal",children:Object(w.jsx)("img",{alt:"loading",src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Floading.svg?alt=media&token=0159e16f-9cd1-4dd9-851d-fa3ad32a9896"})}),Object(w.jsx)(x.a,{isOpen:j,onRequestClose:function(){return e.setState({settingsModal:!1})},className:"settings-modal",children:Object(w.jsxs)("div",{className:"settings-modal-inner",children:[Object(w.jsxs)("div",{className:"settings-fullname",children:[Object(w.jsx)("div",{children:"Password"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{ref:this.passwordRef,type:"password"})}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{onClick:this.handlePassword,children:"Submit"})})]}),Object(w.jsxs)("div",{className:"settings-bio",children:[Object(w.jsx)("div",{children:"Bio"}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{ref:this.bioRef,type:"text"})}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{onClick:this.handleBio,children:"Submit"})})]})]})})]})}}]),s}(n.a.Component),X={image:{height:150,width:150,borderRadius:"50%"},username:{fontSize:24,fontWeight:360},fullName:{fontWeight:550,fontSize:15,marginRight:20},bio:{fontSize:13.5},icon:{height:25,width:25,marginLeft:25}},H=Object(d.e)(z),G=s(48),Z=(s(81),function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(){var e;return Object(m.a)(this,s),(e=t.call(this)).deletePost=function(t,s){var o=e.props.store;o.subscribe((function(){return e.forceUpdate()}));var n=o.getState().postState,a=n.filter((function(e,t){return e.key!==s})),i=n.filter((function(e,o){return e.userId===t&&e.key!==s}));g.collection("users").doc(t).update({posts:i}),o.dispatch(P(a))},e.modifyPost=function(t,s,o,n){var a=e.props.store;a.subscribe((function(){return e.forceUpdate()})),n.caption=o;var i=a.getState().postState,c=i.filter((function(e,t){return e.key!==s}));(i=i.filter((function(e,o){return e.userId===t&&e.key!==s}))).push(n),c.push(n),g.collection("users").doc(t).update({posts:i}),a.dispatch(P(c))},e.state={loading:!0,posts:[]},e}return Object(f.a)(s,[{key:"componentDidMount",value:function(){var e=this,t=[],s=this.props.userId;g.collection("users").doc(s).get().then((function(s){var o=s.data(),n=e.props.store,a=[s.id];for(var i in o.following)a.push(i);n.subscribe((function(){return e.forceUpdate()})),a.forEach((function(s,o){g.collection("users").doc(s).get().then((function(i){var c=i.data(),l=c.username,d=c.profileImg,u=c.posts.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{username:l,profileImg:d,userId:s})}));t.push.apply(t,Object(G.a)(u)),o+1===a.length&&(n.dispatch(P(t)),e.setState({posts:t,loading:!1}))}))}))}))}},{key:"render",value:function(){var e=this,t=this.state.loading,s=this.props,o=s.store,n=s.userId,a=s.username,i=s.profileImg,r=o.getState().postState;return r.sort((function(e,t){return t.time-e.time})),Object(w.jsxs)(w.Fragment,{children:[!t&&Object(w.jsxs)("div",{children:[r.map((function(t){return Object(w.jsx)(B,{username:a,modifyPost:e.modifyPost,deletePost:e.deletePost,userId:n,posts:r,post:t,profileImg:i,store:o},t.key)})),0===r.length&&Object(w.jsxs)("div",{className:"no-data",children:[Object(w.jsx)("div",{children:"No Posts to show"}),Object(w.jsx)("div",{children:Object(w.jsx)(c.b,{to:"/add",children:"Create Post"})})]})]}),Object(w.jsx)(x.a,{isOpen:t,className:"loading-modal",children:Object(w.jsx)("img",{alt:"loading",src:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/Icons%2Floading.svg?alt=media&token=0159e16f-9cd1-4dd9-851d-fa3ad32a9896"})})]})}}]),s}(n.a.Component)),J=(s(82),[]),K=[],Y=[],Q=[],$=[],ee={},te=[],se=Object(u.a)({bookmarkState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_BOOKMARK":return t.bookmarks;default:return e}},feedState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_FEED":return t.feed;default:return e}},postState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_POST":return t.posts;default:return e}},storyState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_STORY":return t.stories;default:return e}},upvoteState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_UPVOTE":return t.upvotes;default:return e}},downvoteState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_DOWNVOTE":return t.downvotes;default:return e}},userState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_USER":return t.user;default:return e}},loginModal:function(){var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SHOW_LOGIN":return!0;case"UNSHOW_LOGIN":default:return!1}}}),oe=(s(83),function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(){var e;return Object(m.a)(this,s),(e=t.call(this)).handleForm=function(t){t.preventDefault();var s=e.emailRef.current.value,o=e.passwordRef.current.value;e.emailRef.current.value="",e.passwordRef.current.value="",v.signInWithEmailAndPassword(s,o).then((function(t){e.props.history.push("/")})).catch((function(e){alert(e.message)}))},e.emailRef=n.a.createRef(),e.passwordRef=n.a.createRef(),e.state={loading:!0},e}return Object(f.a)(s,[{key:"componentDidMount",value:function(){null===v.currentUser&&this.setState({loading:!1})}},{key:"render",value:function(){return Object(w.jsx)("div",{className:"login-main-outer",children:!this.state.loading&&Object(w.jsxs)("div",{className:"login-main",children:[Object(w.jsxs)("div",{className:"login-inner",children:[Object(w.jsx)("div",{className:"login-inner-image",children:Object(w.jsx)("img",{alt:"instagram-logo",src:"https://www.instagram.com/static/images/web/mobile_nav_type_logo-2x.png/1b47f9d0e595.png"})}),Object(w.jsx)("div",{className:"login-inner-second",children:Object(w.jsxs)("form",{className:"login-inner-form",onSubmit:this.handleForm,children:[Object(w.jsx)("input",{ref:this.emailRef,type:"email",placeholder:"Email"}),Object(w.jsx)("input",{ref:this.passwordRef,type:"password",placeholder:"Password"}),Object(w.jsx)("button",{type:"submit",children:"Log In"})]})})]}),Object(w.jsx)("div",{className:"login-signup",children:Object(w.jsxs)("div",{children:["Don't have an account? ",Object(w.jsx)(c.b,{to:"/signup",children:"Sign Up"})]})})]})})}}]),s}(n.a.Component)),ne=Object(d.e)(oe),ae=(s(84),function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(){var e;return Object(m.a)(this,s),(e=t.call(this)).handleForm=function(t){t.preventDefault();var s=e.emailRef.current.value,o=e.passwordRef.current.value,n=e.nameRef.current.value,a=e.usernameRef.current.value;a=a.toLowerCase(),g.collection("users").where("username","==",a).get().then((function(t){!0===t.empty?""!==a&&""!==o&&""!==n&&a.length>5?(e.emailRef.current.value="",e.passwordRef.current.value="",e.nameRef.current.value="",e.usernameRef.current.value="",v.createUserWithEmailAndPassword(s,o).then((function(t){t.user.updateProfile({photoURL:e.state.img,displayName:a});var s={bio:"",bookmarks:[],downvotes:[],followers:{},following:{cYTjXhkqXON1CqFkznHEZwUJwWm1:!0,XgtNb5mWm6VWy20x8WUANSuVZHG2:!0,"9bCOdTirOhPV1gGh93qqU061Cp13":!0},fullName:n,noOfFollowers:0,noOfFollowing:0,noOfPosts:0,posts:[],profileImg:e.state.img,stories:[],upvotes:[],username:a};g.collection("users").doc(t.user.uid).set(s).then((function(){return e.props.history.push("/")})),g.collection("users").doc("cYTjXhkqXON1CqFkznHEZwUJwWm1").get().then((function(e){var s=e.data().followers;s[t.user.uid]=!0,g.collection("users").doc("cYTjXhkqXON1CqFkznHEZwUJwWm1").update({followers:s})})),g.collection("users").doc("XgtNb5mWm6VWy20x8WUANSuVZHG2").get().then((function(e){var s=e.data().followers;s[t.user.uid]=!0,g.collection("users").doc("XgtNb5mWm6VWy20x8WUANSuVZHG2").update({followers:s})})),g.collection("users").doc("9bCOdTirOhPV1gGh93qqU061Cp13").get().then((function(e){var s=e.data().followers;s[t.user.uid]=!0,g.collection("users").doc("9bCOdTirOhPV1gGh93qqU061Cp13").update({followers:s})}))}))):a.length<6?alert("Username must consist of 6 or more characters"):""===o?alert("Password can not be empty"):""===n&&alert("Name can not be empty"):alert("Username not available")}))},e.onChange=function(e,t){if(e.target.files.length>0){var s=new FileReader,o=e.target.files[0];s.onload=function(e){if("image"===e.target.result.substring(5,10)){var s=b.ref(),n=void 0!==this.usernameRef?this.usernameRef.current.value:"",a=(new Date).getTime();s.child("".concat(n).concat(a,".")+o.name.split(".")[1]).put(o).then((function(e){var s=e.ref._delegate.bucket,o=e.ref._delegate.fullPath,n="https://firebasestorage.googleapis.com/v0/b/".concat(s,"/o/").concat(o,"?alt=media");t.setState({img:n})}))}},s.readAsDataURL(e.target.files[0])}},e.emailRef=n.a.createRef(),e.passwordRef=n.a.createRef(),e.nameRef=n.a.createRef(),e.usernameRef=n.a.createRef(),e.state={img:"https://firebasestorage.googleapis.com/v0/b/instagram-clone-a3ccf.appspot.com/o/blank_profile.webp?alt=media&token=dcf458cf-247f-4cb5-8f25-459bc52dd20c"},e}return Object(f.a)(s,[{key:"render",value:function(){var e=this,t=this.state.img;return Object(w.jsx)("div",{className:"login-main-outer",children:Object(w.jsxs)("div",{className:"login-main",children:[Object(w.jsxs)("div",{className:"login-inner",children:[Object(w.jsx)("div",{className:"login-inner-image",children:Object(w.jsx)("img",{alt:"instagram-logo",src:"https://www.instagram.com/static/images/web/mobile_nav_type_logo-2x.png/1b47f9d0e595.png"})}),Object(w.jsxs)("div",{className:"settings-modal-profile",children:[Object(w.jsx)("img",{alt:"profile",style:{height:120,width:120,borderRadius:50,marginBottom:20},src:t}),Object(w.jsx)("input",{onChange:function(t){return e.onChange(t,e)},type:"file"})]}),Object(w.jsx)("div",{className:"login-inner-second",children:Object(w.jsxs)("form",{onSubmit:this.handleForm,className:"login-inner-form",children:[Object(w.jsx)("input",{ref:this.emailRef,type:"email",placeholder:"Email"}),Object(w.jsx)("input",{ref:this.nameRef,type:"text",placeholder:"Full Name"}),Object(w.jsx)("input",{ref:this.usernameRef,type:"text",placeholder:"Username"}),Object(w.jsx)("input",{ref:this.passwordRef,type:"password",placeholder:"Password"}),Object(w.jsx)("button",{children:"Sign up"})]})})]}),Object(w.jsx)("div",{className:"login-signup",children:Object(w.jsxs)("div",{children:["Have an account? ",Object(w.jsx)(c.b,{to:"/",children:"Log in"})]})})]})})}}]),s}(n.a.Component)),ie=Object(d.e)(ae);var ce=function(){var e=Object(o.useState)(""),t=Object(l.a)(e,2),s=t[0],n=t[1],a=Object(o.useState)(""),i=Object(l.a)(a,2),c=i[0],m=i[1],f=Object(o.useState)(""),h=Object(l.a)(f,2),p=h[0],j=h[1],b=Object(o.useState)(!0),O=Object(l.a)(b,2),x=O[0],y=O[1],k=Object(u.b)(se),N=[],I=[],R=[];return v.onAuthStateChanged((function(e){e?(y(!1),n(e.uid),m(e.photoURL),j(e.displayName),g.collection("users").doc(e.uid).get().then((function(e){var t=e.data();N=t.upvotes,I=t.downvotes,R=t.bookmarks,k.dispatch(F(t)),k.dispatch(M(N)),k.dispatch(D(I)),k.dispatch(U(R))}))):(y(!1),n(""),m(""),j(""))})),Object(w.jsxs)(w.Fragment,{children:[" ",!x&&Object(w.jsxs)(w.Fragment,{children:[s&&Object(w.jsxs)("div",{children:[Object(w.jsx)(d.a,{exact:!0,path:"/",children:Object(w.jsx)(S,{})}),Object(w.jsx)(d.a,{exact:!0,path:"/add",children:Object(w.jsx)(S,{})}),Object(w.jsx)(d.a,{exact:!0,path:"/profile",children:Object(w.jsx)(S,{})}),Object(w.jsx)(d.a,{path:"/profile-:username",children:Object(w.jsx)(S,{})}),Object(w.jsx)(d.a,{exact:!0,path:"/",children:Object(w.jsx)(_,{store:k,username:p,userId:s,profileImg:c})}),Object(w.jsx)(d.a,{exact:!0,path:"/add",children:Object(w.jsx)(C,{username:p,userId:s})}),Object(w.jsx)(d.a,{exact:!0,path:"/",children:Object(w.jsx)(Z,{store:k,username:p,userId:s,profileImg:c})}),Object(w.jsx)(d.a,{exact:!0,path:"/profile",children:Object(w.jsx)(H,{store:k,userId:s,username:p,profileImg:c})}),Object(w.jsx)(d.a,{path:"/profile-:username",render:function(e){var t=e.match.params.username;return Object(w.jsx)(H,Object(r.a)({store:k,userId:s,username:t,profileImg:c},e),"username=".concat(t))}})]}),(void 0===v.X||null===v.X)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(d.a,{exact:!0,path:"/",children:Object(w.jsx)(ne,{})}),Object(w.jsx)(d.a,{exact:!0,path:"/signup",children:Object(w.jsx)(ie,{})})]})]})," "]})};i.a.render(Object(w.jsx)(n.a.StrictMode,{children:Object(w.jsx)(c.a,{name:"nikhil",children:Object(w.jsx)(ce,{})})}),document.getElementById("root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.8e6677c1.chunk.js.map